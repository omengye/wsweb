(function(e){function t(t){for(var o,a,i=t[0],c=t[1],l=t[2],u=0,g=[];u<i.length;u++)a=i[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&g.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);h&&h(t);while(g.length)g.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],o=!0,i=1;i<s.length;i++){var c=s[i];0!==r[c]&&(o=!1)}o&&(n.splice(t--,1),e=a(a.s=s[0]))}return e}var o={},r={app:0},n=[];function a(t){if(o[t])return o[t].exports;var s=o[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=o,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(s,o,function(t){return e[t]}.bind(null,o));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var h=c;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"56d7":function(e,t,s){"use strict";s.r(t);s("139e"),s("fae9"),s("3ff7"),s("d6dc"),s("9f45");var o=s("a593"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrapper"},[s("div",{staticClass:"moon",on:{click:e.changeMode}},[s("svg",{staticStyle:{fill:"var(--color-promo-color-modes-toggle-moon)",margin:"12px 0 0 11px"},attrs:{width:"20",height:"18",viewBox:"0 0 20 18","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.28352 10.5764C10.8677 10.5764 14.5839 6.86014 14.5839 2.27596C14.5839 1.7242 14.5301 1.18501 14.4274 0.663368C14.3548 0.294826 14.7414 -0.0153636 15.0516 0.196463C17.4905 1.86202 19.0914 4.66438 19.0914 7.84067C19.0914 12.9493 14.9501 17.0907 9.84145 17.0907C5.24982 17.0907 1.43959 13.7451 0.715408 9.35868C0.654273 8.98839 1.09783 8.76831 1.40118 8.98931C2.77129 9.98745 4.45863 10.5764 6.28352 10.5764Z"}})])]),s("div",{attrs:{id:"container"},on:{click:e.hideSuggest}},[s("div",{attrs:{id:"canvascontainer"},on:{click:e.backhome}},[s("canvas",{attrs:{id:"canvas"}})]),s("div",{staticClass:"input-group",attrs:{id:"search"}},[s("div",{staticClass:"has-icon-right"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],ref:"sinput",staticClass:"form-control form-input",attrs:{id:"search_txt",type:"text",placeholder:"Search for..."},domProps:{value:e.searchText},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.startSearch(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.itemUp(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.itemDown(t)}],input:function(t){t.target.composing||(e.searchText=t.target.value)}}}),s("i",{staticClass:"form-icon icon icon-cross",on:{click:e.cleanText}})]),s("span",{staticClass:"input-group-btn",staticStyle:{float:"left"}},[s("button",{class:[e.sbtnBase,e.sbtn?"loading":""],attrs:{id:"sbtn",type:"button"},on:{click:e.startSearch}},[s("i",{staticClass:"icon icon-search"})])])]),e.showSuggest?s("suggest",{ref:"suggestRes",attrs:{suggests:e.suggests},on:{chooseItem:e.chooseItem}}):e._e(),s("results",{ref:"searchRes",attrs:{sbtn:e.sbtn},on:{"update:sbtn":e.changeSbtn,"update:searchText":e.changeSText}})],1),s("div",{staticClass:"footer"},[s("div",{staticClass:"ipaddr"},[e._v(e._s(e.ipAddr))]),s("div",{staticClass:"copyright"},[e._v(" © "+e._s(e.copyright_year)+". "),s("a",{staticClass:"tooltip tooltip-top",attrs:{"data-tooltip":"丝绸之路"}},[e._v("Silk Road")])])])])},n=[],a=(s("72b3"),s("b131"),s("0bd5"),s("9b42"),s("2df5"),s("79a84"),s("270f"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"suggest"}},e._l(e.suggests,(function(t,o){return s("div",{key:o,staticClass:"sitem",class:{selitem:o===e.cIdx},on:{mouseenter:function(t){return e.menter(o)},click:function(t){return e.clickItem(o)}}},[s("div",{staticClass:"sval",domProps:{innerHTML:e._s(t)}})])})),0)}),i=[],c={name:"Suggest",data:function(){return{cIdx:-1}},props:{suggests:Array},methods:{getHtmlVal:function(e){return document.getElementsByClassName("sval")[e].innerHTML},menter:function(e,t){this.cIdx=e,t?this.$emit("chooseItem",{item:this.getHtmlVal(e),click:!1,cidx:e,key:!0}):this.$emit("chooseItem",{item:this.getHtmlVal(e),click:!1,cidx:e,key:!1})},clickItem:function(e){this.$emit("chooseItem",{item:this.getHtmlVal(e),click:!0,cidx:e})}},computed:{},watch:{}},l=c,h=s("c701"),u=Object(h["a"])(l,a,i,!1,null,"14fe95c6",null),g=u.exports,d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"result"}},[s("div",[s("div",{staticClass:"flip-container"},[s("div",{staticClass:"flipper",attrs:{id:"tools"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showInfo,expression:"showInfo"}],class:["front",e.showMenu?"frontflip":""],attrs:{id:"infos"}},[e.serror?s("div",{staticClass:"errormsg"},[e._v(e._s(e.errorMsg))]):s("div",[e._v("找到约 "),s("span",{attrs:{id:"stotal"}},[e._v(e._s(e.stotal))]),e._v("条记录 (用时 "),s("span",{attrs:{id:"stime"}},[e._v(e._s(e.stime))]),e._v("秒) ")])]),s("div",{class:["back",e.showMenu?"backflip":""],attrs:{id:"selMenu"}},[s("div",{staticClass:"form-group menuForm"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.searchInfo.lr,expression:"searchInfo.lr"}],staticClass:"form-select select-sm",style:{"background-color":e.lrColor},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchInfo,"lr",t.target.multiple?s:s[0])},e.onchange]}},[s("option",{staticClass:"bcolorw",attrs:{value:"-"}},[e._v("不限语言")]),s("option",{staticClass:"bcolorw",attrs:{value:"lang_en"}},[e._v("English")]),s("option",{staticClass:"bcolorw",attrs:{value:"lang_zh-CN"}},[e._v("简体中文")]),s("option",{staticClass:"bcolorw",attrs:{value:"lang_zh-TW"}},[e._v("繁体中文")])])]),s("div",{staticClass:"form-group menuForm menuFormDest"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.searchInfo.dateRestrict,expression:"searchInfo.dateRestrict"}],staticClass:"form-select select-sm",style:{"background-color":e.dateRestrictColor},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchInfo,"dateRestrict",t.target.multiple?s:s[0])},e.onchange]}},[s("option",{staticClass:"bcolorw",attrs:{value:"-"}},[e._v("不限时间")]),s("option",{staticClass:"bcolorw",attrs:{value:"d1"}},[e._v("过去1天")]),s("option",{staticClass:"bcolorw",attrs:{value:"w1"}},[e._v("过去1周")]),s("option",{staticClass:"bcolorw",attrs:{value:"m1"}},[e._v("过去1月")]),s("option",{staticClass:"bcolorw",attrs:{value:"y1"}},[e._v("过去1年")])])]),s("div",{staticClass:"form-group menuForm menuFormDest"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.searchInfo.sort,expression:"searchInfo.sort"}],staticClass:"form-select select-sm",style:{"background-color":e.sortColor},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchInfo,"sort",t.target.multiple?s:s[0])},e.onchange]}},[s("option",{staticClass:"bcolorw",attrs:{value:"-"}},[e._v("相关排序")]),s("option",{staticClass:"bcolorw",attrs:{value:"date"}},[e._v("时间排序")])])])])])]),s("button",{class:[e.menuClassWhite?"bcolorw":"bcolor"],attrs:{id:"menu",type:"button"},on:{click:e.menu}},[s("i",{staticClass:"icon icon-more-horiz"})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.spelling,expression:"spelling"}],staticClass:"correct-spelling"},[s("div",{attrs:{id:"spelling"}},[s("span",[e._v("您是不是要找: ")]),s("a",{on:{click:e.corrQuery}},[e._v(e._s(e.correctedQuery))])])]),s("div",{attrs:{id:"items"}},e._l(e.items,(function(t,o){return s("div",{key:o,staticClass:"item"},[s("div",{staticClass:"title"},[s("a",{staticClass:"link",attrs:{href:t.link,target:"_blank"},domProps:{innerHTML:e._s(t.htmlTitle)}})]),s("div",{staticClass:"formattedUrl"},[e._v(e._s(t.formattedUrl))]),s("div",{staticClass:"htmlSnippet",domProps:{innerHTML:e._s(t.htmlSnippet)}})])})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showPage,expression:"showPage"}],staticStyle:{"margin-top":"10px"}},[s("pagehelper",{ref:"pager",attrs:{enddingPage:e.enddingPage,cpage:e.searchInfo.page},on:{changePage:e.changePage}})],1)])},f=[],p=s("82ae"),m={axiosConfig:{headers:{Authorization:""},timeout:1e4,responseType:"json",responseEncoding:"utf8"},getStorage:function(){return window.localStorage.getItem("access_token")},getNowTime:function(){return Date.parse(new Date)/1e3},requestToken:function(e){var t=this;Object(p["get"])("/api/user/token",this.axiosConfig).then((function(s){var o=s.data;o.tokentime=t.getNowTime(),window.localStorage.setItem("access_token",JSON.stringify(o)),e&&e()})).catch((function(e){t.formatErrorMsg(e)}))},getToken:function(e){var t=this.getStorage();if(t)try{var s=JSON.parse(t),o=this.getNowTime()-s.tokentime;o>s.expire?this.requestToken(e):e&&e()}catch(r){throw window.localStorage.removeItem("access_token"),r}else this.requestToken(e)},queryRequest:function(e,t,s){var o=this,r=!1;if(this.getStorage()){var n=JSON.parse(this.getStorage()),a=this.getNowTime()-n.tokentime;r=a<n.expire}r?this.queryData(e,t,s):(window.localStorage.removeItem("access_token"),this.getToken((function(){o.queryData(e,t,s)})))},queryData:function(e,t,s,o){var r=this,n=JSON.parse(this.getStorage());this.axiosConfig.headers.Authorization="Bearer "+n.token,Object(p["get"])(e,this.axiosConfig).then((function(e){t&&t(e.data)})).catch((function(n){s&&n.response&&401===n.response.status&&!o?(window.localStorage.removeItem("access_token"),r.getToken((function(){r.queryData(e,t,s,!0)}))):s&&n.response&&s(n.response),void 0===n.response&&s({code:"TIMEOUT",message:n.message})}))},formatErrorMsg:function(e){return"ECONNABORTED"===e.code||"TIMEOUT"===e.code?e.message:401===e.status?(window.localStorage.setItem("access_token",""),"ERROR: No Authorization, Please Refresh Page"):429===e.status?"ERROR: Too Many Requests":500===e.status?"ERROR: Internal Server Error":void 0}},v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pagination"},[s("li",{class:{loading:"startp"===e.clickType},staticStyle:{display:"block"},attrs:{id:"startp"}},[s("a",{staticClass:"pbtn",on:{click:function(t){return e.changePage("startp")}}},[e._v("<<")])]),s("li",{directives:[{name:"show",rawName:"v-show",value:e.page>1||"prevp"===e.clickType,expression:"page>1 || clickType==='prevp'"}],class:{loading:"prevp"===e.clickType},attrs:{id:"prevp"}},[s("a",{staticClass:"pbtn",on:{click:function(t){return e.changePage("prevp")}}},[e._v("<")])]),s("li",[s("a",{attrs:{id:"Tpagenum"}},[e._v("Page "+e._s(e.page))])]),s("li",{directives:[{name:"show",rawName:"v-show",value:!e.enddingPage,expression:"!enddingPage"}],class:{loading:"nextp"===e.clickType},attrs:{id:"nextp"}},[s("a",{staticClass:"pbtn",on:{click:function(t){return e.changePage("nextp")}}},[e._v(">")])])])},w=[],y=(s("d0bf"),{name:"Pagehelper",props:{cpage:Number,enddingPage:Boolean},data:function(){return{page:this.cpage<1?1:this.cpage,pagebak:1,clickType:""}},methods:{changePage:function(e){this.clickType=e,"startp"===e?this.page=1:"prevp"===e?this.page-=1:"nextp"===e&&(this.page+=1),this.$emit("changePage",this.page)},commit:function(){this.clickType="",this.pagebak=this.page},rollback:function(){this.clickType="",this.page=this.pagebak}},watch:{cpage:function(){this.page=this.cpage}}}),k=y,I=Object(h["a"])(k,v,w,!1,null,"8ae2cd60",null),b=I.exports,x={name:"Results",props:{sbtn:Boolean},components:{Pagehelper:b},data:function(){return{searchText:"",showInfo:!1,searchInfo:{},rowNum:10,serror:!1,showPage:!1,stotal:0,stime:0,items:[],errorMsg:"",maxPage:10,enddingPage:!1,showMenu:!1,spelling:!1,correctedQuery:"",darkmode:!1}},methods:{showInfoMsg:function(e,t){this.stotal=e,this.stime=t,this.showInfo=!0},errorInfo:function(e){this.serror=!0,this.errorMsg=e,this.showInfo=!0,this.showMenu=!1},showErrorInfo:function(e){this.errorInfo(m.formatErrorMsg(e))},startNum:function(){return(this.searchInfo.page-1)*this.rowNum+1},isEnddingPage:function(){this.enddingPage=(this.maxPage-1)*this.rowNum<this.startNum()||this.searchInfo.page>=1&&this.items.length<this.rowNum},search:function(e,t){var s=this;if(e&&(this.searchInfo=e),t)this.searchText=t;else if(!t&&!this.searchText)return;m.queryRequest("/api/gcs/g"+this.genSearchUrl(),(function(e){if(s.serror=!1,s.$emit("update:sbtn",!1),null==e.searchInformation?(s.items=[],s.errorInfo("No Data Found")):null==e.items?s.items=[]:s.items=e.items,e.searchInformation){var t=e.searchInformation.formattedSearchTime,o=e.searchInformation.formattedTotalResults;s.showInfoMsg(o,t)}s.items.length===s.rowNum&&s.searchInfo.page>0&&(s.showPage=!0),e.spelling&&e.spelling.correctedQuery?(s.spelling=!0,s.correctedQuery=e.spelling.correctedQuery):s.spelling=!1,s.setBrowerUrl(),s.isEnddingPage(),s.$refs.pager.commit(),window.scrollTo(0,0)}),(function(e){s.$emit("update:sbtn",!1),s.$refs.pager.rollback(),s.showErrorInfo(e)}))},changePage:function(e){this.searchInfo.page=e,this.search()},setBrowerUrl:function(){var e="?q="+this.searchText;for(var t in this.searchInfo)this.searchInfo[t]&&"-"!==this.searchInfo[t]&&(e+="&"+t+"="+this.searchInfo[t]);window.history.pushState(null,null,e)},genSearchUrl:function(){var e="?num=10&q="+encodeURI(this.searchText);for(var t in this.searchInfo)if(this.searchInfo[t]&&"-"!==this.searchInfo[t]){if("page"===t){e+="&start="+this.startNum();continue}e+="&"+t+"="+this.searchInfo[t]}return e},menu:function(){this.showMenu=!this.showMenu},corrQuery:function(){this.searchText=this.correctedQuery,this.searchInfo.page=1,this.$emit("update:searchText",this.searchText),this.search()},onchange:function(){this.searchInfo.page=1},colorChange:function(e){return void 0===this.searchInfo||"-"===this.searchInfo[e]?this.getColorMode():this.getColorModeSel()},getColorMode:function(){return this.darkmode?"#2b2b2b":"white"},getColorModeSel:function(){return this.darkmode?"#2b2b2b":"#ececec"}},computed:{lrColor:function(){return this.colorChange("lr")},dateRestrictColor:function(){return this.colorChange("dateRestrict")},sortColor:function(){return this.colorChange("sort")},menuClassWhite:function(){return void 0===this.searchInfo.sort&&void 0===this.searchInfo.lr&&void 0===this.searchInfo.dateRestrict||"-"===this.searchInfo.sort&&"-"===this.searchInfo.lr&&"-"===this.searchInfo.dateRestrict}},watch:{}},C=x,_=Object(h["a"])(C,d,f,!1,null,"5c3dd7d6",null),T=_.exports,S=s("07c3"),P={name:"app",components:{Suggest:g,Results:T},data:function(){return{Utils:m,searchText:"",suggestWait:!1,showSuggest:!1,suggests:[],skipSearch:!1,chooseIdx:-1,sbtn:!1,sbtnBase:"btn btn-primary btn-action btn-lg",ipAddr:"",finTime:0,copyright_year:0,searchInfo:{sort:"-",page:1,lr:"-",dateRestrict:"-"},myFont:new FontFace("Inkfree","url(https://cdn.jsdelivr.net/gh/omengye/wsweb/public/fonts/Inkfree.woff2)"),darkmode:!1}},computed:{},methods:{startSearch:function(){this.searchInfo.page=1,this.search()},search:function(){this.showSuggest=!1,""!==this.searchText&&(this.sbtn=!0),this.$refs.searchRes.search(this.searchInfo,this.searchText)},queryString:function(){var e=location.search.slice(1).split("&"),t={};return e.forEach((function(e){e=e.split("="),t[e[0]]=decodeURIComponent(e[1]||"")})),JSON.parse(JSON.stringify(t))},filterSuggest:function(e){var t=[],s=e;return!(s.length<2)&&s&&s instanceof Array&&s[1]&&s[1]instanceof Array?(s[1].forEach((function(e){t.push(e[0])})),t):t},hideSuggest:function(e){var t=document.getElementById("suggest");t&&!t.contains(e.target)&&(this.showSuggest=!1)},chooseItem:function(e){this.suggests.length>0&&(this.skipSearch=!0,e.item&&(e.click||e.key)?(this.searchText=e.item,this.chooseIdx=e.cidx):e.item?this.chooseIdx=e.cidx:this.showSuggest=!1,e.click&&this.startSearch())},itemUp:function(){this.suggests.length>0&&(this.chooseIdx<=0?this.chooseIdx=this.suggests.length-1:this.chooseIdx-=1,this.$refs.suggestRes.menter(this.chooseIdx,!0))},itemDown:function(){this.suggests.length>0&&(this.chooseIdx===this.suggests.length-1?this.chooseIdx=0:this.chooseIdx+=1,this.$refs.suggestRes.menter(this.chooseIdx,!0))},changeSbtn:function(e){this.finTime=new Date,this.sbtn=e,this.showSuggest=!1},changeSText:function(e){this.searchText=e,this.changeSbtn(!0)},getParamFromUrl:function(){var e=this.queryString();for(var t in this.searchInfo)if(e[t]){if("page"===t){this.searchInfo.page=parseInt(e.page);continue}this.searchInfo[t]=e[t]}e.q&&(this.searchText=e.q)},cleanText:function(){this.searchText="",this.searchInfo.page=1},draw:function(e){this.myFont.load().then((function(t){document.fonts.add(t);var s=document.getElementById("canvas").getContext("2d");s.font="100px Inkfree",s.fillStyle=e;var o="scz.lu";s.fillText(o,32,110)}))},backhome:function(){window.location.href=window.location.origin+window.location.pathname},changeMode:function(){this.darkmode=!this.darkmode,this.$refs.searchRes.darkmode=this.darkmode;var e=document.getElementById("css-mode").href,t=e.split("/")[e.split("/").length-1];this.darkmode?(this.draw("#bcc3ce"),document.getElementById("css-mode").href=e.replace(t,"search-dark.css")):(this.draw("black"),document.getElementById("css-mode").href=e.replace(t,"search.css"))}},watch:{searchText:function(){var e=this;""===this.searchText||this.suggestWait||this.skipSearch||(this.suggestWait=!0,this.finTime=0,this.showSuggest=!1,m.queryRequest("/api/gcs/suggest?q="+encodeURI(this.searchText),(function(t){if(""===e.searchText||e.sbtn||e.finTime>0&&new Date>e.finTime)e.showSuggest=!1;else{var s=e.filterSuggest(t);s.length>0&&(e.showSuggest=!0,e.chooseIdx=-1,e.suggests=s)}}),(function(){e.showSuggest=!1})),Object(S["setTimeout"])((function(){e.suggestWait=!1}),500)),this.skipSearch=!1}},mounted:function(){var e=this;this.$refs["sinput"].focus(),m.getToken((function(){window.localStorage.access_token&&(e.ipAddr="From: "+JSON.parse(window.localStorage.access_token).ip,e.copyright_year=JSON.parse(window.localStorage.access_token).visitTime.substring(0,4),e.getParamFromUrl(),e.search())})),this.draw("black")},created:function(){}},R=P,N=Object(h["a"])(R,r,n,!1,null,null,null),O=N.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(O)}}).$mount("#app")}});