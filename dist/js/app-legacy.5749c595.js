(function(){"use strict";var e={694:function(e,t,s){var r=s(144),i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper"},[t("div",{staticClass:"moon",on:{click:e.changeMode}},[t("svg",{staticStyle:{fill:"var(--color-promo-color-modes-toggle-moon)",margin:"12px 0 0 11px"},attrs:{width:"20",height:"18",viewBox:"0 0 20 18","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.28352 10.5764C10.8677 10.5764 14.5839 6.86014 14.5839 2.27596C14.5839 1.7242 14.5301 1.18501 14.4274 0.663368C14.3548 0.294826 14.7414 -0.0153636 15.0516 0.196463C17.4905 1.86202 19.0914 4.66438 19.0914 7.84067C19.0914 12.9493 14.9501 17.0907 9.84145 17.0907C5.24982 17.0907 1.43959 13.7451 0.715408 9.35868C0.654273 8.98839 1.09783 8.76831 1.40118 8.98931C2.77129 9.98745 4.45863 10.5764 6.28352 10.5764Z"}})])]),t("div",{staticStyle:{display:"none"},attrs:{id:"container"},on:{click:e.hideSuggest}},[t("div",{attrs:{id:"canvascontainer"},on:{click:e.backhome}},[t("canvas",{attrs:{id:"canvas"}})]),t("div",{staticClass:"input-group",attrs:{id:"search"}},[t("div",{staticClass:"has-icon-right"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],ref:"sinput",staticClass:"form-control form-input",attrs:{id:"search_txt",type:"text",placeholder:"Search for..."},domProps:{value:e.searchText},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.startSearch.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.itemUp.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.itemDown.apply(null,arguments)}],input:function(t){t.target.composing||(e.searchText=t.target.value)}}}),t("i",{staticClass:"form-icon icon icon-cross",on:{click:e.cleanText}})]),t("span",{staticClass:"input-group-btn",staticStyle:{float:"left"}},[t("button",{class:[e.sbtnBase,e.sbtn?"loading":""],attrs:{id:"sbtn",type:"button"},on:{click:e.startSearch}},[t("i",{staticClass:"icon icon-search"})])])]),e.showSuggest?t("suggest",{ref:"suggestRes",attrs:{suggests:e.suggests},on:{chooseItem:e.chooseItem}}):e._e(),t("results",{ref:"searchRes",attrs:{sbtn:e.sbtn},on:{"update:sbtn":e.changeSbtn,"update:searchText":e.changeSText}})],1),t("div",{staticClass:"footer"},[t("div",{staticClass:"ipaddr"},[e._v(e._s(e.ipAddr))]),t("div",{staticClass:"copyright"},[e._v(" © "+e._s(e.copyright_year)+". "),t("a",{staticClass:"tooltip tooltip-top",attrs:{"data-tooltip":"丝绸之路"}},[e._v("Silk Road")])])])])},o=[],a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"suggest"}},e._l(e.suggests,(function(s,r){return t("div",{key:r,staticClass:"sitem",class:{selitem:r===e.cIdx},on:{mouseenter:function(t){return e.menter(r)},click:function(t){return e.clickItem(r)}}},[t("div",{staticClass:"sval",domProps:{innerHTML:e._s(s)}})])})),0)},n=[],c={name:"Suggest",data(){return{cIdx:-1}},props:{suggests:Array},methods:{getHtmlVal(e){return document.getElementsByClassName("sval")[e].innerHTML},menter(e,t){this.cIdx=e,t?this.$emit("chooseItem",{item:this.getHtmlVal(e),click:!1,cidx:e,key:!0}):this.$emit("chooseItem",{item:this.getHtmlVal(e),click:!1,cidx:e,key:!1})},clickItem(e){this.$emit("chooseItem",{item:this.getHtmlVal(e),click:!0,cidx:e})}},computed:{},watch:{}},h=c,l=s(1),g=(0,l.Z)(h,a,n,!1,null,"14fe95c6",null),u=g.exports,d=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"result"}},[t("div",[t("div",{staticClass:"flip-container"},[t("div",{staticClass:"flipper",attrs:{id:"tools"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showInfo,expression:"showInfo"}],class:["front",e.showMenu?"frontflip":""],attrs:{id:"infos"}},[e.serror?t("div",{staticClass:"errormsg"},[e._v(e._s(e.errorMsg))]):t("div",[e._v("找到约 "),t("span",{attrs:{id:"stotal"}},[e._v(e._s(e.stotal))]),e._v("条记录 (用时 "),t("span",{attrs:{id:"stime"}},[e._v(e._s(e.stime))]),e._v("秒) ")])]),t("div",{class:["back",e.showMenu?"backflip":""],attrs:{id:"selMenu"}},[t("div",{staticClass:"form-group menuForm"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.searchInfo.lr,expression:"searchInfo.lr"}],staticClass:"form-select select-sm",style:{"background-color":e.lrColor},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchInfo,"lr",t.target.multiple?s:s[0])},e.onchange]}},[t("option",{staticClass:"bcolorw",attrs:{value:"-"}},[e._v("不限语言")]),t("option",{staticClass:"bcolorw",attrs:{value:"lang_en"}},[e._v("English")]),t("option",{staticClass:"bcolorw",attrs:{value:"lang_zh-CN"}},[e._v("简体中文")]),t("option",{staticClass:"bcolorw",attrs:{value:"lang_zh-TW"}},[e._v("繁体中文")])])]),t("div",{staticClass:"form-group menuForm menuFormDest"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.searchInfo.dateRestrict,expression:"searchInfo.dateRestrict"}],staticClass:"form-select select-sm",style:{"background-color":e.dateRestrictColor},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchInfo,"dateRestrict",t.target.multiple?s:s[0])},e.onchange]}},[t("option",{staticClass:"bcolorw",attrs:{value:"-"}},[e._v("不限时间")]),t("option",{staticClass:"bcolorw",attrs:{value:"d1"}},[e._v("过去1天")]),t("option",{staticClass:"bcolorw",attrs:{value:"w1"}},[e._v("过去1周")]),t("option",{staticClass:"bcolorw",attrs:{value:"m1"}},[e._v("过去1月")]),t("option",{staticClass:"bcolorw",attrs:{value:"y1"}},[e._v("过去1年")])])]),t("div",{staticClass:"form-group menuForm menuFormDest"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.searchInfo.sort,expression:"searchInfo.sort"}],staticClass:"form-select select-sm",style:{"background-color":e.sortColor},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.searchInfo,"sort",t.target.multiple?s:s[0])},e.onchange]}},[t("option",{staticClass:"bcolorw",attrs:{value:"-"}},[e._v("相关排序")]),t("option",{staticClass:"bcolorw",attrs:{value:"date"}},[e._v("时间排序")])])])])])]),t("button",{class:[e.menuClassWhite?"bcolorw":"bcolor"],attrs:{id:"menu",type:"button"},on:{click:e.menu}},[t("i",{staticClass:"icon icon-more-horiz"})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.spelling,expression:"spelling"}],staticClass:"correct-spelling"},[t("div",{attrs:{id:"spelling"}},[t("span",[e._v("您是不是要找: ")]),t("a",{on:{click:e.corrQuery}},[e._v(e._s(e.correctedQuery))])])]),t("div",{attrs:{id:"items"}},e._l(e.items,(function(s,r){return t("div",{key:r,staticClass:"item"},[t("div",{staticClass:"title"},[t("a",{staticClass:"link",attrs:{href:s.link,target:"_blank"},domProps:{innerHTML:e._s(s.htmlTitle)}})]),t("div",{staticClass:"formattedUrl"},[e._v(e._s(s.formattedUrl))]),t("div",{staticClass:"htmlSnippet",domProps:{innerHTML:e._s(s.htmlSnippet)}})])})),0),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showPage,expression:"showPage"}],staticStyle:{"margin-top":"10px"}},[t("pagehelper",{ref:"pager",attrs:{enddingPage:e.enddingPage,cpage:e.searchInfo.page},on:{changePage:e.changePage}})],1)])},p=[],m=s(669),f={axiosConfig:{headers:{Authorization:""},timeout:1e4,responseType:"json",responseEncoding:"utf8"},getStorage(){return window.localStorage.getItem("access_token")},getNowTime(){return Date.parse(new Date)/1e3},requestToken(e){(0,m.get)("/api/user/token",this.axiosConfig).then((t=>{let s=t.data;s.tokentime=this.getNowTime(),window.localStorage.setItem("access_token",JSON.stringify(s)),e&&e()})).catch((e=>{this.formatErrorMsg(e)}))},getToken(e){let t=this.getStorage();if(t)try{let s=JSON.parse(t),r=this.getNowTime()-s.tokentime;r>s.expire?this.requestToken(e):e&&e()}catch(s){throw window.localStorage.removeItem("access_token"),s}else this.requestToken(e)},queryRequest(e,t,s){let r=!1;if(this.getStorage()){let e=JSON.parse(this.getStorage()),t=this.getNowTime()-e.tokentime;r=t<e.expire}r?this.queryData(e,t,s):(window.localStorage.removeItem("access_token"),this.getToken((()=>{this.queryData(e,t,s)})))},queryData(e,t,s,r){let i=JSON.parse(this.getStorage());this.axiosConfig.headers.Authorization="Bearer "+i.token,(0,m.get)(e,this.axiosConfig).then((e=>{t&&t(e.data)})).catch((i=>{s&&i.response&&401===i.response.status&&!r?(window.localStorage.removeItem("access_token"),this.getToken((()=>{this.queryData(e,t,s,!0)}))):s&&i.response&&s(i.response),void 0===i.response&&s({code:"TIMEOUT",message:i.message})}))},formatErrorMsg(e){return"ECONNABORTED"===e.code||"TIMEOUT"===e.code?e.message:401===e.status?(window.localStorage.setItem("access_token",""),"ERROR: No Authorization, Please Refresh Page"):429===e.status?"ERROR: Too Many Requests":500===e.status?"ERROR: Internal Server Error":void 0}},v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pagination"},[t("li",{class:{loading:"startp"===e.clickType},staticStyle:{display:"block"},attrs:{id:"startp"}},[t("a",{staticClass:"pbtn",on:{click:function(t){return e.changePage("startp")}}},[e._v("<<")])]),t("li",{directives:[{name:"show",rawName:"v-show",value:e.page>1||"prevp"===e.clickType,expression:"page>1 || clickType==='prevp'"}],class:{loading:"prevp"===e.clickType},attrs:{id:"prevp"}},[t("a",{staticClass:"pbtn",on:{click:function(t){return e.changePage("prevp")}}},[e._v("<")])]),t("li",[t("a",{attrs:{id:"Tpagenum"}},[e._v("Page "+e._s(e.page))])]),t("li",{directives:[{name:"show",rawName:"v-show",value:!e.enddingPage,expression:"!enddingPage"}],class:{loading:"nextp"===e.clickType},attrs:{id:"nextp"}},[t("a",{staticClass:"pbtn",on:{click:function(t){return e.changePage("nextp")}}},[e._v(">")])])])},w=[],k={name:"Pagehelper",props:{cpage:Number,enddingPage:Boolean},data(){return{page:this.cpage<1?1:this.cpage,pagebak:1,clickType:""}},methods:{changePage(e){this.clickType=e,"startp"===e?this.page=1:"prevp"===e?this.page-=1:"nextp"===e&&(this.page+=1),this.$emit("changePage",this.page)},commit(){this.clickType="",this.pagebak=this.page},rollback(){this.clickType="",this.page=this.pagebak}},watch:{cpage(){this.page=this.cpage}}},y=k,I=(0,l.Z)(y,v,w,!1,null,"8ae2cd60",null),x=I.exports,C={name:"Results",props:{sbtn:Boolean},components:{Pagehelper:x},data(){return{searchText:"",showInfo:!1,searchInfo:{},rowNum:10,serror:!1,showPage:!1,stotal:0,stime:0,items:[],errorMsg:"",maxPage:10,enddingPage:!1,showMenu:!1,spelling:!1,correctedQuery:"",darkmode:!1}},methods:{showInfoMsg(e,t){this.stotal=e,this.stime=t,this.showInfo=!0},errorInfo(e){this.serror=!0,this.errorMsg=e,this.showInfo=!0,this.showMenu=!1},showErrorInfo(e){this.errorInfo(f.formatErrorMsg(e))},startNum(){return(this.searchInfo.page-1)*this.rowNum+1},isEnddingPage(){this.enddingPage=(this.maxPage-1)*this.rowNum<this.startNum()||this.searchInfo.page>=1&&this.items.length<this.rowNum},search(e,t){if(e&&(this.searchInfo=e),t)this.searchText=t;else if(!t&&!this.searchText)return;f.queryRequest("/api/gcs/g"+this.genSearchUrl(),(e=>{if(this.serror=!1,this.$emit("update:sbtn",!1),null==e.searchInformation?(this.items=[],this.errorInfo("No Data Found")):null==e.items?this.items=[]:this.items=e.items,e.searchInformation){let t=e.searchInformation.formattedSearchTime,s=e.searchInformation.formattedTotalResults;this.showInfoMsg(s,t)}this.items.length===this.rowNum&&this.searchInfo.page>0&&(this.showPage=!0),e.spelling&&e.spelling.correctedQuery?(this.spelling=!0,this.correctedQuery=e.spelling.correctedQuery):this.spelling=!1,this.setBrowerUrl(),this.isEnddingPage(),this.$refs.pager.commit(),window.scrollTo(0,0)}),(e=>{this.$emit("update:sbtn",!1),this.$refs.pager.rollback(),this.showErrorInfo(e)}))},changePage(e){this.searchInfo.page=e,this.search()},setBrowerUrl(){let e="?q="+this.searchText;for(let t in this.searchInfo)this.searchInfo[t]&&"-"!==this.searchInfo[t]&&(e+="&"+t+"="+this.searchInfo[t]);window.history.pushState(null,null,e)},genSearchUrl(){var e="?num=10&q="+encodeURI(this.searchText);for(var t in this.searchInfo)if(this.searchInfo[t]&&"-"!==this.searchInfo[t]){if("page"===t){e+="&start="+this.startNum();continue}e+="&"+t+"="+this.searchInfo[t]}return e},menu(){this.showMenu=!this.showMenu},corrQuery(){this.searchText=this.correctedQuery,this.searchInfo.page=1,this.$emit("update:searchText",this.searchText),this.search()},onchange(){this.searchInfo.page=1},colorChange(e){return void 0===this.searchInfo||"-"===this.searchInfo[e]?this.getColorMode():this.getColorModeSel()},getColorMode(){return this.darkmode?"#2b2b2b":"white"},getColorModeSel(){return this.darkmode?"#2b2b2b":"#ececec"}},computed:{lrColor(){return this.colorChange("lr")},dateRestrictColor(){return this.colorChange("dateRestrict")},sortColor(){return this.colorChange("sort")},menuClassWhite(){return void 0===this.searchInfo.sort&&void 0===this.searchInfo.lr&&void 0===this.searchInfo.dateRestrict||"-"===this.searchInfo.sort&&"-"===this.searchInfo.lr&&"-"===this.searchInfo.dateRestrict}},watch:{}},b=C,T=(0,l.Z)(b,d,p,!1,null,"5c3dd7d6",null),_=T.exports,S=s(475),P={name:"app",components:{Suggest:u,Results:_},data(){return{Utils:f,searchText:"",suggestWait:!1,showSuggest:!1,suggests:[],skipSearch:!1,chooseIdx:-1,sbtn:!1,sbtnBase:"btn btn-primary btn-action btn-lg",ipAddr:"",finTime:0,copyright_year:0,searchInfo:{sort:"-",page:1,lr:"-",dateRestrict:"-"},myFont:new FontFace("Inkfree","url(https://cdn.jsdelivr.net/gh/omengye/wsweb/public/fonts/Inkfree.woff2)"),darkmode:!1}},computed:{},methods:{startSearch(){this.searchInfo.page=1,this.search()},search(){this.showSuggest=!1,""!==this.searchText&&(this.sbtn=!0),this.$refs.searchRes.search(this.searchInfo,this.searchText)},queryString(){var e=location.search.slice(1).split("&"),t={};return e.forEach((function(e){e=e.split("="),t[e[0]]=decodeURIComponent(e[1]||"")})),JSON.parse(JSON.stringify(t))},filterSuggest(e){let t=[],s=e;return!(s.length<2)&&s&&s instanceof Array&&s[1]&&s[1]instanceof Array?(s[1].forEach((e=>{t.push(e[0])})),t):t},hideSuggest(e){let t=document.getElementById("suggest");t&&!t.contains(e.target)&&(this.showSuggest=!1)},chooseItem(e){this.suggests.length>0&&(this.skipSearch=!0,e.item&&(e.click||e.key)?(this.searchText=e.item,this.chooseIdx=e.cidx):e.item?this.chooseIdx=e.cidx:this.showSuggest=!1,e.click&&this.startSearch())},itemUp(){this.suggests.length>0&&(this.chooseIdx<=0?this.chooseIdx=this.suggests.length-1:this.chooseIdx-=1,this.$refs.suggestRes.menter(this.chooseIdx,!0))},itemDown(){this.suggests.length>0&&(this.chooseIdx===this.suggests.length-1?this.chooseIdx=0:this.chooseIdx+=1,this.$refs.suggestRes.menter(this.chooseIdx,!0))},changeSbtn(e){this.finTime=new Date,this.sbtn=e,this.showSuggest=!1},changeSText(e){this.searchText=e,this.changeSbtn(!0)},getParamFromUrl(){const e=this.queryString();for(var t in this.searchInfo)if(e[t]){if("page"===t){this.searchInfo.page=parseInt(e.page);continue}this.searchInfo[t]=e[t]}e.q&&(this.searchText=e.q)},cleanText(){this.searchText="",this.searchInfo.page=1,this.$refs["sinput"].focus()},draw(e){this.myFont.load().then((t=>{document.fonts.add(t);const s=document.getElementById("canvas").getContext("2d");s.font="100px Inkfree",s.fillStyle=e;const r="scz.lu";s.fillText(r,32,110)}))},backhome(){window.location.href=window.location.origin+window.location.pathname},initMode(){this.$refs.searchRes.darkmode=this.darkmode;let e=document.getElementById("css-mode").href,t=e.split("/")[e.split("/").length-1];this.darkmode?(this.draw("#bcc3ce"),document.getElementById("css-mode").href=e.replace(t,"search-dark.css")):(this.draw("black"),document.getElementById("css-mode").href=e.replace(t,"search.css")),document.getElementById("container").style["display"]="block"},changeMode(){this.darkmode=!this.darkmode,localStorage.setItem("mode",this.darkmode),this.initMode()}},watch:{searchText(){""===this.searchText||this.suggestWait||this.skipSearch||(this.suggestWait=!0,this.finTime=0,this.showSuggest=!1,f.queryRequest("/api/gcs/suggest?q="+encodeURI(this.searchText),(e=>{if(""===this.searchText||this.sbtn||this.finTime>0&&new Date>this.finTime)return void(this.showSuggest=!1);let t=this.filterSuggest(e);t.length>0&&(this.showSuggest=!0,this.chooseIdx=-1,this.suggests=t)}),(()=>{this.showSuggest=!1})),(0,S.setTimeout)((()=>{this.suggestWait=!1}),500)),this.skipSearch=!1}},mounted(){this.$refs["sinput"].focus(),f.getToken((()=>{window.localStorage.access_token&&(this.ipAddr="From: "+JSON.parse(window.localStorage.access_token).ip,this.copyright_year=JSON.parse(window.localStorage.access_token).visitTime.substring(0,4),this.getParamFromUrl(),this.search())})),null!==localStorage.getItem("mode")&&(this.darkmode=JSON.parse(localStorage.getItem("mode"))),this.initMode()},created(){}},N=P,R=(0,l.Z)(N,i,o,!1,null,null,null),M=R.exports;r.ZP.config.productionTip=!1,new r.ZP({render:e=>e(M)}).$mount("#app")}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,r,i,o){if(!r){var a=1/0;for(l=0;l<e.length;l++){r=e[l][0],i=e[l][1],o=e[l][2];for(var n=!0,c=0;c<r.length;c++)(!1&o||a>=o)&&Object.keys(s.O).every((function(e){return s.O[e](r[c])}))?r.splice(c--,1):(n=!1,o<a&&(a=o));if(n){e.splice(l--,1);var h=i();void 0!==h&&(t=h)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[r,i,o]}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,o,a=r[0],n=r[1],c=r[2],h=0;if(a.some((function(t){return 0!==e[t]}))){for(i in n)s.o(n,i)&&(s.m[i]=n[i]);if(c)var l=c(s)}for(t&&t(r);h<a.length;h++)o=a[h],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(l)},r=self["webpackChunksczlu"]=self["webpackChunksczlu"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(694)}));r=s.O(r)})();